@model SalesAndInentoryWeb_Application.tbl_OtherIncome
@{
    ViewBag.Title = "OtherIncome";
    Layout = "~/Views/Shared/ideal.cshtml";
}
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    @Html.DevExpress().GetStyleSheets(
        new StyleSheet { ExtensionSuite = ExtensionSuite.NavigationAndLayout },
        new StyleSheet { ExtensionSuite = ExtensionSuite.Editors }
    )
    @Html.DevExpress().GetScripts(
        new Script { ExtensionSuite = ExtensionSuite.NavigationAndLayout },
        new Script { ExtensionSuite = ExtensionSuite.Editors }
    )

    <style>
        .scrolldown {
            overflow-y: scroll;
            height: 100px;
        }
        textarea.form-control {
            height: 40px;
            margin: 0px;
            resize: vertical;
        }

         yourCustomClass{
         height: 40px;
            margin: 0px;
            resize: vertical;
          
        }
      
    </style>
    <script src="~/scripts/jquery-1.12.4.min.js"></script>
    <script type="text/javascript">
        $("#ItemName").change(function () {
            var fruitId = $(this).find("option:selected").val();
            if (fruitId != "") {
                $.ajax({
                    type: "POST",
                    url: "/SaleOrder/GetFruitName",
                    data: "id=" + fruitId,
                    success: function (response) {
                        if (response != "") {
                            $("#SalePrice").val(response);
                        } else {
                            $("#txtopeningbal").val('');
                        }
                    }
                });
            } else {
                $("#txtopeningbal").val('');
            }
        });

        $(document).ready(function () {
            $("#btnaddtolist").click(function () {
                AddToItem();
            });
            $("#tblSaleInvoice").on('click', '#remove', function () {

                var curentreo = $(this).closest("tr");
            
                var pretotal = curentreo.find("td:eq(3)").text();
                var pretotal1 = $("#total1").val();
                var find = pretotal1 - pretotal           
           
                $("#total1").val(find);
                $(curentreo).closest('tr').remove();

            });
            $("#btnsubmit").click(function (e) {
                additems();
            });
            $("#Id1").change(function () {
                debugger
                var fruitId = $(this).find("option:selected").val();
                if (fruitId != "") {
                    $.ajax({
                        type: "POST",
                        url: "/OtherIncome/GetFruitName",
                        data: "id=" + fruitId,
                        success: function (response) {
                            if (response != "") {
                                $("#mrp").val(response);
                            } else {
                                $("#mrp").val('');
                            }
                        }
                    });
                } else {
                    $("#mrp").val('');
                }
            });
        });
      
        function minus() {
            var pretotal1 = $("#Total").val();
            var pretotal2 = $("#Balance").val();
            var find = pretotal1 - pretotal2
            $("#Paid").val(find);
        };
        function  cal()
        {
            var mrp = $("#mrp").val();
            var qty = $("#qty").val();
            var total = mrp * qty;
            $("#Total").val(total);
        }
        
        function cal1() {
            var mrp = $("#mrp").val();
           $("#qty").val(1);
            var total = mrp * 1;
            $("#Total").val(total);
        }
        function AddToItem()
        {
            var tableitemlist = $("#tblSaleInvoice");
            var ItemName = $("#Id1 option:selected").val();
            var mrp = $("#mrp").val();  
            var qty = $("#qty").val();        
            var total = $("#Total").val();

            var itemlist = "<tr><div class='scrollit' ><td>" + ItemName + "</td><td>" + mrp + "</td><td>"
            + qty + "</td><td>" + total + "</td><td> <input type='button' value='Remove' name='remove' id='remove' class='btn btn-danger' /></td></tr>"
            tableitemlist.append(itemlist);
            reset();
            var finding = 0;
            $("tr").each(function (indexTr) {
             
              var mm = +$(this).find('td:eq(3)').text();
              finding=finding+mm
             
                $("#total1").val(finding);
            })
        }
        function reset()
        {
            $("#ItemName").val('');
            $("#mrp").val('');
            $("#qty").val('');
            $("#Total").val('');          
        }
        function additems() {
            debugger
            var objOtherIncomeDetails = {};
            var listofotherincomedetails = [];

            $.each($("#tblSaleInvoice tbody tr"),
                function () {
                    listofotherincomedetails.push({
                        ItemName: $(this).find("td:eq(0)").text(),
                        SalePrice: $(this).find("td:eq(1)").text(),
                        Qty: $(this).find("td:eq(2)").text(),
                        ItemAmount: $(this).find("td:eq(3)").text()
                    });
                });

            objOtherIncomeDetails.ExpenseCategory = $("#CategoryID option:selected").val();
            objOtherIncomeDetails.Date = $("#Date").val();
            objOtherIncomeDetails.Received = $("#Received").val();
            objOtherIncomeDetails.Balance = $("#Balance").val();
            objOtherIncomeDetails.Total = $("#Total").val();
            objOtherIncomeDetails.DeleteData = $("#DeleteData").val();

            objOtherIncomeDetails.ListOfOtherIncomeDetails = listofotherincomedetails;


            $.ajax({
                async: true,
                type: "POST",
                datatype: 'JSON',
                contentType: 'application/json;charset=utf-8',
                data: JSON.stringify(objOtherIncomeDetails),
                url: '/Expence/AddOrEdit',
                success: function (data) {
                    if (data.status == true) {
                        alter(data.message);
                    }
                },
                error: function () {
                    alert("error");
                }

            });

        }
    </script>
</head>
<body>
    @using (Html.BeginForm())
    {
        <div class="panel panel-primary container" style="height:100%; width:100%;">
            <div class="panel-heading"><a class="btn" href=@Url.Action("Index", "OtherIncome") style="background-color:#05445E;color:white">Back To List</a><p style="margin-left:486px;margin-top: -31px;font-weight:bold;font-size:15px;">OtherIncome</p></div>
            <div class="panel border-box">

                <div class="container-fluid">
                    <div class="collapse navbar-collapse ">

                        <div class="row">
                            <div class="form-group col-md-3">
                                @*<div class="pull-right">
                                    @Html.DevExpress().Label(settings =>
                                    {
                                        settings.Style["font-weight"] = "bold";
                                        settings.Name = "Label1";
                                        settings.Text = "Party Name   :";
                                    }).GetHtml()
                                    </div>*@
                                <br />
                        Category :
                                @Html.DropDownListFor(model => model.CategoryID, Model.ListOfCategory as IEnumerable<SelectListItem>, "Select Category", new { htmlAttributes = new { } })


                                @*<select name="cars" id="dp" class="form-control" style="width:220px;height:32px">
                                    <option>---Party Name--</option>
                                    <option value="volvo">Rahul</option>
                                    <option value="saab">Vithoba</option>
                                    <option value="mercedes">Pallavi</option>
                                    <option value="audi">Bhagyashri</option>
                                </select>*@
                            </div>
                            <div class="form-group col-md-7">
                                <div class="pull-right">
                                    @*Po No
                                        @Html.EditorFor(model => model.PONo, new { htmlAttributes = new { @class = "form-control", placeholder = "Po Number", @style = "width:150px;height:30px" } })
                                        @Html.ValidationMessageFor(model => model.CategoryID)
                                        Po Date:
                                        <input placeholder="PO Date" class="textbox-n form-control" style="width:150px;height:30px;" type="text" onfocus="(this.type='date')" id="date">
                                        Barcode:
                                        @Html.EditorFor(model => model.Barcode, new { htmlAttributes = new { @class = "form-control", placeholder = "BarcodNo", @style = "width:150px;height:30px" } })
                                        @Html.ValidationMessageFor(model => model.Barcode)*@
                                </div>







                            </div>


                            <div class="form-group col-md-2">

								<div class="pull-right">

									@*State :
		<select name="state" id="state" class="form-control" style="width:150px;height:30px;">
			<option value="Andhra Pradesh">Andhra Pradesh</option>
			<option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
			<option value="Arunachal Pradesh">Arunachal Pradesh</option>
			<option value="Assam">Assam</option>
			<option value="Bihar">Bihar</option>
			<option value="Chandigarh">Chandigarh</option>
			<option value="Chhattisgarh">Chhattisgarh</option>
			<option value="Dadar and Nagar Haveli">Dadar and Nagar Haveli</option>
			<option value="Daman and Diu">Daman and Diu</option>
			<option value="Delhi">Delhi</option>
			<option value="Lakshadweep">Lakshadweep</option>
			<option value="Puducherry">Puducherry</option>
			<option value="Goa">Goa</option>
			<option value="Gujarat">Gujarat</option>
			<option value="Haryana">Haryana</option>
			<option value="Himachal Pradesh">Himachal Pradesh</option>
			<option value="Jammu and Kashmir">Jammu and Kashmir</option>
			<option value="Jharkhand">Jharkhand</option>
			<option value="Karnataka">Karnataka</option>
			<option value="Kerala">Kerala</option>
			<option value="Madhya Pradesh">Madhya Pradesh</option>
			<option value="Maharashtra">Maharashtra</option>
			<option value="Manipur">Manipur</option>
			<option value="Meghalaya">Meghalaya</option>
			<option value="Mizoram">Mizoram</option>
			<option value="Nagaland">Nagaland</option>
			<option value="Odisha">Odisha</option>
			<option value="Punjab">Punjab</option>
			<option value="Rajasthan">Rajasthan</option>
			<option value="Sikkim">Sikkim</option>
			<option value="Tamil Nadu">Tamil Nadu</option>
			<option value="Telangana">Telangana</option>
			<option value="Tripura">Tripura</option>
			<option value="Uttar Pradesh">Uttar Pradesh</option>
			<option value="Uttarakhand">Uttarakhand</option>
			<option value="West Bengal">West Bengal</option>
		</select>*@
                                    <br />
								    Date:
									@Html.TextBoxFor(model => model.Date, new { @type = "date", @class = "form-control", @style = "width:150px;" })
								</div>
                            </div>
                        </div>


                    </div>
                </div>

                <br />

                <nav class="navbar navbar-default " style="border:none; background-color:white">
                    <div class="container-fluid">
                        <div class="collapse navbar-collapse ">
                            <div class="form-group scrolldown" style="height:200px">

                                <table class="table table-striped table-bordered" style="width:100%;" id="tblSaleInvoice">

                                    <thead>

                                        <tr>

                                            <th>
                                                <label>Item Name</label>
                                                @Html.DropDownListFor(model=>model.Id1, Model.ListOfAccounts as IEnumerable<SelectListItem>, "Select Item", new { htmlAttributes = new { @Style = "width:20px;height:20px;", @class = "vits", @id = "ItemName", @name = "ItemName" } })

                                               </th>
                                            <th>
                                                <label>MRP</label>  

                                                <input type="text" id="mrp" name="" onchange="cal1()"  class="form-control" style="width:100PX">
                                            </th>                                        
                                            
                                            <th>
                                                <label>Qty</label>
                                                <input type="text" id="qty" name="" onchange="cal()" class="form-control" style="width:100PX">
                                            </th>
                                            <th>
                                                <label>Total</label>
                                                <input type="text" id="Total" name="" class="form-control" style="width:100PX">
                                            </th>
                                          
                                            <th>
                                                <a class="btn btn-primary pull-right" style="margin-top:20px;" id="btnaddtolist"><i class="fa fa-plus"></i>Add Item</a>
                                            </th>

                                        </tr>
                                    </thead>

                                </table>
                            </div>
                        </div>
                    </div>
                </nav>

                <div class="container-fluid">

                        <div class="row">

                            <div class="col-md-6">
                             

                             
                            </div>
                            <div class="col-md-2 form-group">
                                Total :
                                @Html.EditorFor(model => model.total, new { htmlAttributes = new { @class = "form-control", placeholder = "Total Amount", @id = "total1" } })
                                @Html.ValidationMessageFor(model => model.total)


                            </div>

                            <div class="col-md-2">
                                Recived:
                                @Html.EditorFor(model => model.Received, new { htmlAttributes = new { @class = "form-control", placeholder = "Recive Ammount",@onchange="minus()" } })
                                @Html.ValidationMessageFor(model => model.Received)

                            </div>
                            <div class="col-md-2 form-group">
                               
                                      
                                    Remining Bal:
                                    @Html.EditorFor(model => model.Balance, new { htmlAttributes = new { @class = "form-control", placeholder = "Remining Balance" } })
                                    @Html.ValidationMessageFor(model => model.Balance)
                                
                            </div>

                        </div>


                 
                    <div class="row">
                        <div class="col-md-6">




                        </div>
                        <div class="col-md-3">




                        </div>
                        <div class="col-md-3">
                            <input type="submit" value="Submit" class="btn btn-primary pull-left" style="margin-right:12px; width:100px;" id="btnsubmit" />
                            <input type="reset" value="Clear" class="btn btn-primary pull-right" style="margin-right:12px; width:100px;" />

                        </div>
                        

                    </div>


                </div>
            </div>
            <div>

            </div>
        </div>



    }









    <br />

    <br />

    <br />

    <br />

    <br />

    <br />

    <br />

    <br />

    <br />

    <br />

</body>
</html>
